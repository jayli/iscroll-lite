/*!build time : 2013-12-04 1:39:23 PM*/
KISSY.add("gallery/iscroll-lite/1.0/index",function(){return function(){var a=Math,b=function(a){return a>>0},c=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"",d=(/android/gi.test(navigator.appVersion),/iphone|ipad/gi.test(navigator.appVersion)),e=/playbook/gi.test(navigator.appVersion),f=/hp-tablet/gi.test(navigator.appVersion),g="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,h="ontouchstart"in window&&!f,i=c+"Transform"in document.documentElement.style,j=d||e,k=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,17)}}(),l=function(){return window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),m="onorientationchange"in window?"orientationchange":"resize",n=h?"touchstart":"mousedown",o=h?"touchmove":"mousemove",p=h?"touchend":"mouseup",q=h?"touchcancel":"mouseup",r="translate"+(g?"3d(":"("),s=g?",0)":")",t=function(a,b){var d,e=this,f=document;e.wrapper="object"==typeof a?a:f.getElementById(a),e.wrapper.style.overflow="hidden",e.scroller=e.wrapper.children[0],e.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null};for(d in b)e.options[d]=b[d];e.x=e.options.x,e.y=e.options.y,e.options.useTransform=i?e.options.useTransform:!1,e.options.hScrollbar=e.options.hScroll&&e.options.hScrollbar,e.options.vScrollbar=e.options.vScroll&&e.options.vScrollbar,e.options.useTransition=j&&e.options.useTransition,e.scroller.style[c+"TransitionProperty"]=e.options.useTransform?"-"+c.toLowerCase()+"-transform":"top left",e.scroller.style[c+"TransitionDuration"]="0",e.scroller.style[c+"TransformOrigin"]="0 0",e.options.useTransition&&(e.scroller.style[c+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)"),e.options.useTransform?e.scroller.style[c+"Transform"]=r+e.x+"px,"+e.y+"px"+s:e.scroller.style.cssText+=";position:absolute;top:"+e.y+"px;left:"+e.x+"px",e.refresh(),e._bind(m,window),e._bind(n),h||e._bind("mouseout",e.wrapper)};t.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],handleEvent:function(a){var b=this;switch(a.type){case n:if(!h&&0!==a.button)return;b._start(a);break;case o:b._move(a);break;case p:case q:b._end(a);break;case m:b._resize();break;case"mouseout":b._mouseout(a);break;case"webkitTransitionEnd":b._transitionEnd(a)}},_resize:function(){this.refresh()},_pos:function(a,d){a=this.hScroll?a:0,d=this.vScroll?d:0,this.options.useTransform?this.scroller.style[c+"Transform"]=r+a+"px,"+d+"px"+s+" scale("+this.scale+")":(a=b(a),d=b(d),this.scroller.style.left=a+"px",this.scroller.style.top=d+"px"),this.x=a,this.y=d},_start:function(a){var b,d,e,f=this,g=h?a.touches[0]:a;f.enabled&&(f.options.onBeforeScrollStart&&f.options.onBeforeScrollStart.call(f,a),f.options.useTransition&&f._transitionTime(0),f.moved=!1,f.animating=!1,f.zoomed=!1,f.distX=0,f.distY=0,f.absDistX=0,f.absDistY=0,f.dirX=0,f.dirY=0,f.options.momentum&&(f.options.useTransform?(b=getComputedStyle(f.scroller,null)[c+"Transform"].replace(/[^0-9-.,]/g,"").split(","),d=1*b[4],e=1*b[5]):(d=1*getComputedStyle(f.scroller,null).left.replace(/[^0-9-]/g,""),e=1*getComputedStyle(f.scroller,null).top.replace(/[^0-9-]/g,"")),(d!=f.x||e!=f.y)&&(f.options.useTransition?f._unbind("webkitTransitionEnd"):l(f.aniTime),f.steps=[],f._pos(d,e))),f.absStartX=f.x,f.absStartY=f.y,f.startX=f.x,f.startY=f.y,f.pointX=g.pageX,f.pointY=g.pageY,f.startTime=a.timeStamp||Date.now(),f.options.onScrollStart&&f.options.onScrollStart.call(f,a),f._bind(o),f._bind(p),f._bind(q))},_move:function(b){var c=this,d=h?b.touches[0]:b,e=d.pageX-c.pointX,f=d.pageY-c.pointY,g=c.x+e,i=c.y+f,j=b.timeStamp||Date.now();c.options.onBeforeScrollMove&&c.options.onBeforeScrollMove.call(c,b),c.pointX=d.pageX,c.pointY=d.pageY,(g>0||g<c.maxScrollX)&&(g=c.options.bounce?c.x+e/2:g>=0||c.maxScrollX>=0?0:c.maxScrollX),(i>0||i<c.maxScrollY)&&(i=c.options.bounce?c.y+f/2:i>=0||c.maxScrollY>=0?0:c.maxScrollY),c.distX+=e,c.distY+=f,c.absDistX=a.abs(c.distX),c.absDistY=a.abs(c.distY),c.absDistX<6&&c.absDistY<6||(c.options.lockDirection&&(c.absDistX>c.absDistY+5?(i=c.y,f=0):c.absDistY>c.absDistX+5&&(g=c.x,e=0)),c.moved=!0,c._pos(g,i),c.dirX=e>0?-1:0>e?1:0,c.dirY=f>0?-1:0>f?1:0,j-c.startTime>300&&(c.startTime=j,c.startX=c.x,c.startY=c.y),c.options.onScrollMove&&c.options.onScrollMove.call(c,b))},_end:function(c){if(!h||0==c.touches.length){var d,e,f,g,i=this,j=h?c.changedTouches[0]:c,k={dist:0,time:0},l={dist:0,time:0},m=(c.timeStamp||Date.now())-i.startTime,n=i.x,r=i.y;if(i._unbind(o),i._unbind(p),i._unbind(q),i.options.onBeforeScrollEnd&&i.options.onBeforeScrollEnd.call(i,c),!i.moved){if(h){for(d=j.target;1!=d.nodeType;)d=d.parentNode;"SELECT"!=d.tagName&&"INPUT"!=d.tagName&&"TEXTAREA"!=d.tagName&&(e=document.createEvent("MouseEvents"),e.initMouseEvent("click",!0,!0,c.view,1,j.screenX,j.screenY,j.clientX,j.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null),e._fake=!0,d.dispatchEvent(e))}return i._resetPos(200),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,c),void 0}if(300>m&&i.options.momentum&&(k=n?i._momentum(n-i.startX,m,-i.x,i.scrollerW-i.wrapperW+i.x,i.options.bounce?i.wrapperW:0):k,l=r?i._momentum(r-i.startY,m,-i.y,i.maxScrollY<0?i.scrollerH-i.wrapperH+i.y:0,i.options.bounce?i.wrapperH:0):l,n=i.x+k.dist,r=i.y+l.dist,(i.x>0&&n>0||i.x<i.maxScrollX&&n<i.maxScrollX)&&(k={dist:0,time:0}),(i.y>0&&r>0||i.y<i.maxScrollY&&r<i.maxScrollY)&&(l={dist:0,time:0})),k.dist||l.dist)return f=a.max(a.max(k.time,l.time),10),i.options.snap&&(distX=n-i.absStartX,distY=r-i.absStartY,a.abs(distX)<i.options.snapThreshold&&a.abs(distY)<i.options.snapThreshold?i.scrollTo(i.absStartX,i.absStartY,200):(g=i._snap(n,r),n=g.x,r=g.y,f=a.max(g.time,f))),i.scrollTo(b(n),b(r),f),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,c),void 0;if(i.options.snap)return distX=n-i.absStartX,distY=r-i.absStartY,a.abs(distX)<i.options.snapThreshold&&a.abs(distY)<i.options.snapThreshold?i.scrollTo(i.absStartX,i.absStartY,200):(g=i._snap(i.x,i.y),(g.x!=i.x||g.y!=i.y)&&i.scrollTo(g.x,g.y,g.time)),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,c),void 0;i._resetPos(200),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,c)}},_resetPos:function(a){var b=this,c=b.x>=0?0:b.x<b.maxScrollX?b.maxScrollX:b.x,d=b.y>=0||b.maxScrollY>0?0:b.y<b.maxScrollY?b.maxScrollY:b.y;return c==b.x&&d==b.y?(b.moved&&(b.options.onScrollEnd&&b.options.onScrollEnd.call(b),b.moved=!1),void 0):(b.scrollTo(c,d,a||0),void 0)},_mouseout:function(a){var b=a.relatedTarget;if(!b)return this._end(a),void 0;for(;b=b.parentNode;)if(b==this.wrapper)return;this._end(a)},_transitionEnd:function(a){var b=this;a.target==b.scroller&&(b._unbind("webkitTransitionEnd"),b._startAni())},_startAni:function(){var b,c,d,e=this,f=e.x,g=e.y,h=Date.now();if(!e.animating){if(!e.steps.length)return e._resetPos(400),void 0;if(b=e.steps.shift(),b.x==f&&b.y==g&&(b.time=0),e.animating=!0,e.moved=!0,e.options.useTransition)return e._transitionTime(b.time),e._pos(b.x,b.y),e.animating=!1,b.time?e._bind("webkitTransitionEnd"):e._resetPos(0),void 0;d=function(){var i,j,l=Date.now();return l>=h+b.time?(e._pos(b.x,b.y),e.animating=!1,e.options.onAnimationEnd&&e.options.onAnimationEnd.call(e),e._startAni(),void 0):(l=(l-h)/b.time-1,c=a.sqrt(1-l*l),i=(b.x-f)*c+f,j=(b.y-g)*c+g,e._pos(i,j),e.animating&&(e.aniTime=k(d)),void 0)},d()}},_transitionTime:function(a){this.scroller.style[c+"TransitionDuration"]=a+"ms"},_momentum:function(c,d,e,f,g){var h=6e-4,i=a.abs(c)/d,j=i*i/(2*h),k=0,l=0;return c>0&&j>e?(l=g/(6/(j/i*h)),e+=l,i=i*e/j,j=e):0>c&&j>f&&(l=g/(6/(j/i*h)),f+=l,i=i*f/j,j=f),j*=0>c?-1:1,k=i/h,{dist:j,time:b(k)}},_offset:function(a){for(var b=-a.offsetLeft,c=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,c-=a.offsetTop;return{left:b,top:c}},_snap:function(b,c){var d,e,f,g,h,i,j=this;for(f=j.pagesX.length-1,d=0,e=j.pagesX.length;e>d;d++)if(b>=j.pagesX[d]){f=d;break}for(f==j.currPageX&&f>0&&j.dirX<0&&f--,b=j.pagesX[f],h=a.abs(b-j.pagesX[j.currPageX]),h=h?a.abs(j.x-b)/h*500:0,j.currPageX=f,f=j.pagesY.length-1,d=0;f>d;d++)if(c>=j.pagesY[d]){f=d;break}return f==j.currPageY&&f>0&&j.dirY<0&&f--,c=j.pagesY[f],i=a.abs(c-j.pagesY[j.currPageY]),i=i?a.abs(j.y-c)/i*500:0,j.currPageY=f,g=a.round(a.max(h,i))||200,{x:b,y:c,time:g}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){var a=this;a.scroller.style[c+"Transform"]="",a._unbind(m,window),a._unbind(n),a._unbind(o),a._unbind(p),a._unbind(q),a._unbind("mouseout",a.wrapper),a.options.useTransition&&a._unbind("webkitTransitionEnd"),a.options.onDestroy&&a.options.onDestroy.call(a)},refresh:function(){var a,b,d,e,f=this,g=0,h=0;if(f.wrapperW=f.wrapper.clientWidth,f.wrapperH=f.wrapper.clientHeight,f.scrollerW=f.scroller.offsetWidth,f.scrollerH=f.scroller.offsetHeight,f.maxScrollX=f.wrapperW-f.scrollerW,f.maxScrollY=f.wrapperH-f.scrollerH,f.dirX=0,f.dirY=0,f.hScroll=f.options.hScroll&&f.maxScrollX<0,f.vScroll=f.options.vScroll&&(!f.options.bounceLock&&!f.hScroll||f.scrollerH>f.wrapperH),a=f._offset(f.wrapper),f.wrapperOffsetLeft=-a.left,f.wrapperOffsetTop=-a.top,"string"==typeof f.options.snap)for(f.pagesX=[],f.pagesY=[],e=f.scroller.querySelectorAll(f.options.snap),b=0,d=e.length;d>b;b++)g=f._offset(e[b]),g.left+=f.wrapperOffsetLeft,g.top+=f.wrapperOffsetTop,f.pagesX[b]=g.left<f.maxScrollX?f.maxScrollX:g.left*f.scale,f.pagesY[b]=g.top<f.maxScrollY?f.maxScrollY:g.top*f.scale;else if(f.options.snap){for(f.pagesX=[];g>=f.maxScrollX;)f.pagesX[h]=g,g-=f.wrapperW,h++;for(f.maxScrollX%f.wrapperW&&(f.pagesX[f.pagesX.length]=f.maxScrollX-f.pagesX[f.pagesX.length-1]+f.pagesX[f.pagesX.length-1]),g=0,h=0,f.pagesY=[];g>=f.maxScrollY;)f.pagesY[h]=g,g-=f.wrapperH,h++;f.maxScrollY%f.wrapperH&&(f.pagesY[f.pagesY.length]=f.maxScrollY-f.pagesY[f.pagesY.length-1]+f.pagesY[f.pagesY.length-1])}f.scroller.style[c+"TransitionDuration"]="0",f._resetPos(200)},scrollTo:function(a,b,c,d){var e,f,g=this,h=a;for(g.stop(),h.length||(h=[{x:a,y:b,time:c,relative:d}]),e=0,f=h.length;f>e;e++)h[e].relative&&(h[e].x=g.x-h[e].x,h[e].y=g.y-h[e].y),g.steps.push({x:h[e].x,y:h[e].y,time:h[e].time||0});g._startAni()},scrollToElement:function(b,c){var d,e=this;b=b.nodeType?b:e.scroller.querySelector(b),b&&(d=e._offset(b),d.left+=e.wrapperOffsetLeft,d.top+=e.wrapperOffsetTop,d.left=d.left>0?0:d.left<e.maxScrollX?e.maxScrollX:d.left,d.top=d.top>0?0:d.top<e.maxScrollY?e.maxScrollY:d.top,c=void 0===c?a.max(2*a.abs(d.left),2*a.abs(d.top)):c,e.scrollTo(d.left,d.top,c))},scrollToPage:function(a,b,c){var d,e,f=this;c=void 0===c?400:c,f.options.onScrollStart&&f.options.onScrollStart.call(f),f.options.snap?(a="next"==a?f.currPageX+1:"prev"==a?f.currPageX-1:a,b="next"==b?f.currPageY+1:"prev"==b?f.currPageY-1:b,a=0>a?0:a>f.pagesX.length-1?f.pagesX.length-1:a,b=0>b?0:b>f.pagesY.length-1?f.pagesY.length-1:b,f.currPageX=a,f.currPageY=b,d=f.pagesX[a],e=f.pagesY[b]):(d=-f.wrapperW*a,e=-f.wrapperH*b,d<f.maxScrollX&&(d=f.maxScrollX),e<f.maxScrollY&&(e=f.maxScrollY)),f.scrollTo(d,e,c)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(o),this._unbind(p),this._unbind(q)},enable:function(){this.enabled=!0},stop:function(){l(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1}},"undefined"!=typeof exports?exports.iScroll=t:window.iScroll=t}(),window.iScroll});